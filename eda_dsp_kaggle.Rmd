

```{r setup}
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE)
```

#Exploring Data Science Programs

*Michelle Audirac*

*Valeria Perez-Cong*

**If you're looking for the Data Science program that is right for you, this notebook will help you get started in your search!**

Finding the graduate program that best fits you has never been an easy task. Finding the right Data Science program might even be harder! the soaring hunger for data-savvy workforce in all industries has rocketed the offering of Data Science programs. 

If you are interested in data, then there is a good chance that instead of surfing the web for DS programs you plan on storing scraped university pages data, to then build a dashboard and explore it.

**Good news is**, you found this post and you won't have to begin your project from scratch since we provide an EDA of a kaggle [dataset](https://www.kaggle.com/sriharirao/datascience-universities-across-us) containing web scraped DS programs data. You can also check out the shiny app that we built with this dataset [here](LIGA).

But first, chill! Not so fast...

Data Science programs come in a variety of colors and flavors. As wide-ranging, interdisciplinary and clouded in hype as the term -Data Science- can be, first figure out what is the data outfit you want to wear:

**Step 1** make sure you understand whether you are looking to style your business intelligence skills or if your looking to fly your machine learning ship, as these are different journeys. Deep-dive into whether you would like to specialize in bio or urban applications. 

**Step 2** depending on where you arrived at in step 1, filter out programs and departments.  Ask yourself if you wish to continue working as you might want to consider the online and part time programs space.

**Step 3** go through this notebook's content, use our shiny app to get insights...then use these insights to make an intelligent web surf and finally make an informed decision.

**hApPy DS program search!!**

## Loading packages

We require the packages listed in the code chunk below to run the notebook.

```{r}
require(magrittr, quietly = TRUE, warn.conflicts = FALSE)
require(dplyr, quietly = TRUE, warn.conflicts = FALSE)
require(tidyr, quietly = TRUE, warn.conflicts = FALSE)
require(ggplot2, quietly = TRUE, warn.conflicts = FALSE)
require(plotly, quietly = TRUE, warn.conflicts = FALSE)
# require(leaflet, quietly = TRUE, warn.conflicts = FALSE)
# require(rgdal, quietly = TRUE, warn.conflicts = FALSE)
# require(ngram, quietly = TRUE, warn.conflicts = FALSE)
```

##  Metadata

Let's read the [Data Science Universities across US](https://www.kaggle.com/sriharirao/datascience-universities-across-us) dataset and print its structure.

```{r}
dsp <- read.csv("./timesMergedData.csv")
str(dsp)
```

With this, we infer the dataset's metadata:

Field | Type | Description
----|----|----
SCHOOL | String | school PGRM_NAME
STATE | String | state
CITY | String | city
NOC | Numeric | ?
PROGRAM | String | program PGRM_NAME
TYPE | String | : 'C' - Certificate, 'M' - Master
DEPARTMENT | String | department PGRM_NAME
DELIVERY | String | campus, on line or hybrid
DURATION | String | duraiion
PREREQ | String | prerequisites
LINK | String | link
LOC_LAT | Numeric | latitude
LOC_LONG | Numeric | longitude
WORLD_RANK | Numeric | school's world ranking
COUNTRY | String | USA
TEACHING | Numeric | ?
INTERNATIONAL | Numeric | ?
RESEARCH | Numeric | ?
CITATIONS | Numeric | ?
INCOME | Numeric | ?
TOTAL_SCORE | Numeric | ? 
NUM_STUDENTS | Numeric | school's number of students
STUDENT_STAFF_RATIO | Numeric | ? 
INTERNATIONAL_STUDENTS | String | school's percentage of international students
F_M_RATIO | String | ?
YEAR | Numeric | program's year
timesData | Numeric | ?

## Preparing data

Look how Data Science has gained groud through the years

```{r}
summary(as.factor(dsp$YEAR))
```

Let's filter programs with entries in 2016 or unknown year. We will drop any duplicates.

```{r}
dsp %<>% filter(YEAR == 2016 | is.na(YEAR)) %>% distinct()
```

Now, we will include a program ID
```{r}
dsp <- dsp %>% 
  mutate(ID = 1:nrow(dsp))
```

Finally, in the next section we will munge and visualize the columns listed below.

  * `DELIVERY`
  * `DEPARTMENT`
  * `PREREQ`
  * `PROGRAM`
  * `TYPE`

## Univariate EDA

### Delivery

Let's take a look at `DELIVERY`'s categories.

```{r}
table(dsp$DELIVERY)
```

They look pretty dirty. We will recode them and viz the percentage of DS programs split by the new `DELIVERY`'s categories.

```{r}
dsp %<>% 
  mutate(DELIVERY = recode(DELIVERY, 
                            'Blended' = 'Hybrid',
                            'Campus and online' = 'Hybrid',
                            'Campus or Online' = 'Campus or online',
                            'Campus, Online' = 'Campus or online',
                            'On Campus' = 'Campus',
                            'Online (one Saturday per month on-campus)' = 'Hybrid',
                            'Online or Campus' = 'Campus or online',
                            'Online or On Campus' = 'Campus or online',
                            'Online or campus' = 'Campus or online',
                            'Online, campus, or hybrid' = 'Campus or online'))

ggplotly(
    dsp %>% 
      group_by(DELIVERY) %>% 
      summarize(n = n()) %>% 
      mutate(perc = round(n / sum(n), 4)*100) %>% 
      mutate(str_perc = paste0(perc, "%")) %>% 
      ggplot(aes(x = reorder(DELIVERY, n), 
                 y = perc, 
                 fill = as.factor(DELIVERY))) + 
      geom_col(position = "stack", colour = 'grey', alpha = 0.7, width = .5) + 
      labs(title = "DS Programs by Delivery", x = "", y = "") + 
      theme_bw() + 
      labs(fill = "Delivery", 
           y = "", 
           x = "") + 
      scale_y_continuous(limits = c(0,100)) + 
      geom_text(aes(label = str_perc)) + 
      theme(legend.position="none")
    )
```

### Department

Let's take a look at some entries in `DEPARTMENT`.

```{r}
head(dsp$DEPARTMENT)
```

With the department name, we will create seven 'big' department categories: 

* Business 
* Math 
* Statistics
* Computer Science (CS)
* Data Science (DS)
* Engineering
* Technology

```{r echo=T, warning=FALSE, error=FALSE, message=FALSE}
dsp %<>% 
  mutate(DEPARTMENT = as.character(DEPARTMENT)) %>% 
  mutate(DEPARTMENT = tolower(DEPARTMENT))

DEPT_CAT <- dsp %>% 
  select(ID, DEPARTMENT)  %>%
  mutate(dept_business = 
           grepl("business", DEPARTMENT) | 
           grepl("management", DEPARTMENT) | 
           grepl("administration", DEPARTMENT) |
           grepl("administrative", DEPARTMENT), 
         dept_math = 
           grepl("math", DEPARTMENT) | 
           grepl("mathematics", DEPARTMENT) | 
           grepl("mathematical", DEPARTMENT), 
         dept_statistics = 
           grepl("statistics", DEPARTMENT) | 
           grepl("statistical", DEPARTMENT),  
         dept_cs = 
           grepl("computer science", DEPARTMENT) | 
           grepl("computer sciences", DEPARTMENT) | 
           grepl("computer", DEPARTMENT), 
         dept_ds = 
           grepl("data science", DEPARTMENT) | 
           grepl("data sciences", DEPARTMENT), 
         dept_engineering = 
           grepl("engineer", DEPARTMENT) | 
           grepl("engineering", DEPARTMENT), 
         dept_technology = 
           grepl("tech", DEPARTMENT) | 
           grepl("technological", DEPARTMENT) | 
           grepl("technology", DEPARTMENT) | 
           grepl("information technology", DEPARTMENT))
```

It is important to mention that a single program can fall into different department categories and some programs don't fall into any category. 

```{r}
DEPT_CAT %<>% 
  mutate(sum_dept = dept_business + dept_math + dept_statistics + 
           dept_cs + dept_ds + dept_engineering + 
           dept_technology)

table(DEPT_CAT$sum_dept)
```

Finally, we will create a bar plot with the department categories.

```{r}
ggplotly(
  DEPT_CAT %>% 
    gather(dept_business, 
           dept_math, 
           dept_statistics, 
           dept_cs, dept_ds, 
           dept_engineering, 
           dept_technology, 
           key = "dept", value = "present") %>% 
    filter(present == 1) %>% 
    mutate(dept = sub("dept_","",dept)) %>% 
    group_by(dept) %>% 
    summarise(n = n()) %>% 
    mutate(perc = round(n / sum(n), 4) * 100, 
           str_perc = paste0(perc, "%")) %>% 
    ggplot(aes(x = reorder(dept, n), 
               y = perc, 
               fill = as.factor(dept))) + 
    geom_col(colour = 'grey', alpha = 0.7, width = .5) + 
    theme_bw() +
    theme(axis.text.x = element_text(angle = 65, 
                                     vjust = 0.5, 
                                     hjust = 1, 
                                     size = rel(0.9)) #, 
          #plot.background = element_rect(fill = "white"), 
          #panel.background = element_rect(fill = "white", colour = "grey50"), 
          #legend.position = "bottom"
          ) + 
    labs(title = "DS Programs per Department", 
         x = "", 
         y = "") + 
    scale_y_continuous(limits = c(0,100)) + 
    geom_text(aes(label = str_perc)) + 
    theme(legend.position="none")
  )
 
```

### Prerequisites

The prerequisites in `PREREQ` are:

* Technical bachelor's degree
* Computer science
* Math
* Statistics
* Economics
* Biology

and not available

```{r}
dsp %<>% 
  mutate(PREREQ = as.character(PREREQ)) %>% 
  mutate(PREREQ = tolower(PREREQ))

PREREQ_CAT <- 
  dsp %>% 
  select(ID, PREREQ) %>% 
  mutate(biology = grepl("biology", PREREQ), 
         computer_science = grepl("computer science", PREREQ), 
         math = grepl("math", PREREQ), 
         statistics = grepl("stat", PREREQ), 
         economics = grepl("eco", PREREQ), 
         not_available = grepl("not", PREREQ), 
         bachelor_degree = grepl("degree", PREREQ))
```

Let's visualize the prerequisites for the ds programs

```{r}
ggplotly(
  PREREQ_CAT %>% 
  gather(biology, 
         computer_science, 
         math, 
         statistics, 
         economics, 
         not_available, 
         bachelor_degree, 
         key = "prereq", 
         value = "present") %>% 
    filter(present == 1) %>% 
    mutate(prereq = sub("_", " ", prereq)) %>% 
    group_by(prereq) %>% 
    summarise(n = n()) %>% 
    mutate(perc = round(n / sum(n), 4) * 100, 
           str_perc = paste0(perc, "%")) %>% 
    ggplot(aes(x=reorder(prereq, n), 
               y = perc, 
               fill = as.factor(prereq))) + 
    geom_col(colour = 'grey', alpha = 0.7, width = .5) + 
    geom_text(aes(label = str_perc)) + 
    theme(axis.text.x = element_text(angle = 65, 
                                     vjust = 0.5, 
                                     hjust = 1, 
                                     size = rel(0.9)),
          plot.background = element_rect(fill = "white"),
          panel.background = element_rect(fill = "white", colour = "grey50"),
          legend.position = "bottom") + 
    labs(title = "DS Programs per Prerequisite", 
       x = "", 
       y = "") + 
    scale_y_continuous(limits = c(0,100)) + 
    theme(legend.position="none")
  )
```

### Program

`PROGRAM` contains program names. Although these names provide us program information, such as the major or concentration, there is little we can do with the raw names in `PROGRAM`. To extract the information, we will use regular expressions.

```{r}
dsp %<>% 
  mutate(PROGRAM = as.character(PROGRAM)) %>% 
  mutate(PROGRAM = tolower(PROGRAM))

# \\b means 'word boundary'
PGRM_NAME <- dsp$PROGRAM %>% 
  gsub('\\.|\\:|\\,', '', .) %>%
  gsub('\\&', 'and', .) %>%
  gsub('\\(|\\)', '', .) %>%
  
  gsub('master\'s', 'master', .) %>% 
  gsub('masters', 'master', .) %>%
  gsub('\\bms\\b', '*M* *MS* *Sc*', .) %>%
  gsub('master of science', '*M* *MS* *Sc*', .) %>%
  gsub('\\bmba\\b', '*M* *MBA* *B*', .) %>%
  gsub('master of business administration', '*M* *MBA* *B*', .) %>%
  gsub('master of business and science', '*M* *B* *Sc*', .) %>%
  gsub('master', '*M*', .) %>%
  
  gsub('diploma', '*Cert*', .) %>%
  gsub('certificate', '*Cert*', .) %>%
  
  gsub('doctor', '*PhD*', .) %>%
  gsub('phd', '*PhD*', .) %>%
  
  gsub('\\bds\\b', '*DS*', .) %>%
  gsub('computational data science', '*DS* *CS* *Sc*' , .) %>%
  gsub('computational and data science', '*DS* *CS* *Sc*', .) %>%
  gsub('data science', '*DS*', .) %>%
  gsub('computer science', '*CS* *Sc*', .) %>%
  gsub('computational science', '*CS* *Sc*', .) %>%
  
  gsub('business analytics', '*BI-Analytics* *B*', .) %>%
  gsub('\\bbi\\b', '*BI-Analytics* *B*', .) %>%
  gsub('business intelligence', '*BI-Analytics* *B*', .) %>%
  
  gsub('data mining', 'mining', .) %>%
  gsub('mining', '*BI-Analytics*', .) %>%
  
  gsub('data analytics', 'analytics', .) %>%
  gsub('analysis', 'analytics', .) %>% 
  gsub('analytics', 'BI-Analytics* *B*', .) %>%
  
  gsub('applied statistics', 'statistics', .) %>%
  gsub('statistical', 'statistics', .) %>%
  gsub('statistics', '*Stats* *Sc*', .) %>%
  
  gsub('information systems technology', '*IT-IS*', .) %>%
  gsub('management information systems', '*IM* *B*', .) %>%
  gsub('information management', 'im', .) %>%
  gsub('information systems', 'is', .) %>%
  gsub('\\bim\\b', '*IM* *B*', .) %>%
  gsub('\\bis\\b', '*IT-IS*', .) %>%
  gsub('information technology', 'it', .) %>%
  gsub('\\bit\\b', '*IT-IS*', .) %>%
  
  # gsub('health', '*Health-Bio*', .) %>%
  # gsub('bio', '*Health-Bio*', .) %>%
  # gsub('urban', '*Urban*', .) %>%
  # gsub('public', '*Public*', .) %>% 
  # gsub('management', '*Mgmt*', .) %>% 
  
  gsub('\\bin\\b|\\band\\b|\\bof\\b|\\bwith\\b|\\ba\\b|\\bfor\\b|\\bthe\\b|\\bat\\b', '', .) %>% 
  gsub('^a |^the ', '', .)

dsp$PGRM_NAME <- PGRM_NAME

# words <- unlist(strsplit(PGRM_NAME," "))
# words <- as.data.frame(table(words)) %>% arrange(desc(Freq))
# words
```

With the key words that we extracted from `PROGRAM`, we can now create a classification for our programs and viz the percentage of DS programs split by the new `program_classification`'s categories: (note that we did not build disjoint classes and not all programs could be classified)

* *BI_Analytics* Business Intelligence and Analytics
* *CS* Computer Science 
* *DS* Data Science 
* *IM* Information Management
* *IT IS* Information Technology and Information Systems 
* *Stats* Statistics

```{r}
PGRM_CAT <- dsp %>% 
  select(ID, 
         PGRM_NAME) %>% 
  mutate(DS = grepl("\\*DS\\*", PGRM_NAME), 
         CS = grepl("\\*CS\\*", PGRM_NAME), 
         BI_Analytics = grepl("\\*BI-Analytics\\*", PGRM_NAME), 
         Stats = grepl("*\\Stats\\*", PGRM_NAME), 
         IT_IS = grepl("*\\IT-IS\\*", PGRM_NAME), 
         IM = grepl("\\*IM\\*", PGRM_NAME)) %>% 
  mutate(DS = if_else(BI_Analytics, FALSE, DS)) 

ggplotly(
  PGRM_CAT %>% 
    gather(DS, CS, BI_Analytics, Stats, IT_IS, IM, key = "pgrm", value = "present") %>% 
    filter(present == 1) %>% 
    mutate(pgrm = sub("_", " ", pgrm)) %>% 
    group_by(pgrm) %>% 
    summarize(n = n()) %>% 
    mutate(perc = round(n / sum(n), 4)*100) %>% 
    mutate(str_perc = paste0(perc, "%")) %>% 
    ggplot(aes(x = reorder(pgrm, n), 
               y = perc, 
               fill = as.factor(pgrm))) + 
    geom_col(position = "stack", colour = 'grey', alpha = 0.7, width = .5) + 
    labs(title = "DS Programs by Classification", x = "", y = "") + 
    theme_bw() + 
    labs(fill = "Classification", y = "", x = "") + 
    scale_y_continuous(limits = c(0,100)) + 
    geom_text(aes(label = str_perc))
)
```

### Type

`TYPE` splits the programs in `C` certificates and `M` master degrees.

```{r}
table(dsp$TYPE)
```

Finally, we will modify `TYPE` taking into account what we extracted from `PROGRAM`.

```{r}
TYPE_CAT <- dsp %>% 
  select(ID, 
         PGRM_NAME) %>% 
  mutate(MBA = grepl("\\*MBA\\*", PGRM_NAME), 
         MS = grepl("\\*MS\\*", PGRM_NAME), 
         PhD = grepl("\\*PhD\\*", PGRM_NAME), 
         C = grepl("*\\Cert\\*", PGRM_NAME))

TYPE_CAT %<>% 
  mutate(sum_type = MBA + MS + PhD + C) %>% 
  filter(sum_type == 1) %>% 
  gather(MBA, MS, PhD, C, key = "type", value = "present") %>% 
  filter(present == 1) %>% 
  mutate(type = sub("_", " ", type)) %>% 
  select(ID, type)

dsp %<>% 
  mutate(TYPE = as.character(TYPE)) %>% 
  left_join(TYPE_CAT)

dsp$TYPE[!is.na(dsp$type)] <- dsp$type[!is.na(dsp$type)]

ggplotly(
    dsp %>% 
      group_by(TYPE) %>% 
      summarize(n = n()) %>% 
      mutate(perc = round(n / sum(n), 4)*100) %>% 
      mutate(str_perc = paste0(perc, "%")) %>% 
      ggplot(aes(x = reorder(TYPE, n), 
                 y = perc, 
                 fill = as.factor(TYPE))) + 
      geom_col(position = "stack", colour = 'grey', alpha = 0.7, width = .5) + 
      labs(title = "DS Programs by Delivery Type", x = "", y = "") + 
      theme_bw() + 
      labs(y = "", 
           x = "") + 
      scale_y_continuous(limits = c(0,100)) + 
      geom_text(aes(label = str_perc)) + 
      theme(legend.position="none")
    )
```

## Bivariate EDA

In this section we will look at the offering of DS programs by department and program.

### Department

### Program

## Where to find more?

This notebook is the result of several hours spent playing in kaggle, creating notebooks and exploring previous work on the matter. Here, some of the material that was used:

*  Srihari Rao's kaggle's dataset: [Data Science Universities across US](https://www.kaggle.com/sriharirao/datascience-universities-across-us)
*  Benjamin Lott's kaggle's notebook: [Examining Data Science Related Programs in the US] (https://www.kaggle.com/benjaminlott/examining-data-science-related-programs-in-the-us)
*  UC Business Analytics R Programming Guide: [Advanced Plots with ggplot](http://uc-r.github.io/ggplot)

## About the authors

Michelle and Valeria are currently working at Datank, Mexican -machine learning as a service- provider.
